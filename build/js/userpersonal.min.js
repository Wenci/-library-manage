$(function(){$("#left_nav>li").click(function(a){$("#left_nav>li.active").removeClass("active"),$(this).addClass("active"),0==$(this).index()?($("#person-data").css("display","block"),$("#change-password").css("display","none"),$("#person-title").text("个人信息")):($("#person-data").css("display","none"),$("#change-password").css("display","block"),$("#person-title").text("修改密码"))}),$("a.edit").click(function(a){$(this).closest("li").css("display","none"),$(this).closest("li").next().css("display","block")}),$("a[data-type=cancel]").click(function(a){$(this).closest("li").css("display","none"),$(this).closest("li").prev().css("display","block")});var a=!1;$("a.submit").click(function(b){if(1!=a){a=!0;var c,d=$(this).attr("data-type");if(c="sex"==d?$("input:radio:checked").val():$("#"+d).val(),""==c)return layer.msg("请输入内容"),void(a=!1);if("phone"==d){var e=/^1[3|4|5|8][0-9]\d{4,8}$/;if(!e.test(c))return layer.msg("手机号码格式不正确"),void(a=!1)}console.log({type:d,newValue:c}),$.post("/user/personal",{type:d,newValue:c},function(b,c,d){a=!1,"error"==b?(layer.msg("修改失败"),window.location.reload()):"success"==b&&(layer.msg("修改成功"),window.location.reload())})}});var b=!1;$("#submit-pass").click(function(a){if(1!=b){b=!0;var c=$("#old-pass").val(),d=$("#new-pass").val();return c.length<6?(layer.msg("请输入正确的当前密码"),void(b=!1)):""==d?(layer.msg("请输入新密码"),void(b=!1)):d.length<6?(layer.msg("新密码过于简单"),void(b=!1)):c==d?(layer.msg("新密码和当前密码一样"),void(b=!1)):void $.post("/user/personal",{type:"password",oldPassword:c,newPassword:d},function(a,c,d){b=!1,"error"==a?(layer.msg("修改失败"),window.location.reload()):"success"==a&&(layer.msg("修改成功"),window.location.reload())})}})});